#Turbo 40

Sub Main 
    /declare announceChannel string outer say 
    :MainLoop
        /if (${FindItemCount[=Vasty Deep Ale]} <4) {
            /docommand /${announceChannel} out of Vasty Deep Ale
            /echo \aoGo Get Ale in Erudin
            /end
        } else {
            /call GiveAle
        }
    /goto :mainLoop

/return 

Sub GiveAle
    /tar Shondo 
    /delay 2
    | Open Inventory to grab muffins
	/keypress open_inv_bags
	/delay 5

    /declare givenCount int local 0
    /declare packSlot   int local ${FindItem[=Vasty Deep Ale].ItemSlot}
    /varcalc packSlot ${packSlot}
    /echo packSlot: ${packSlot}

    | item notify uses old pack numbers 1-8
    /declare notifyPackSlot int local 0
    /varcalc notifyPackSlot ${packSlot} - 22
    /echo \awnotifyPackSlot: \ag${notifyPackSlot}

    /declare notifyItemSlot int local ${FindItem[=Vasty Deep Ale].ItemSlot2}
    /varcalc notifyItemSlot ${notifyItemSlot} + 1
    /echo \awnotifyItemSlot: \ag${notifyItemSlot}

    

    :giveLoop
    /nomodkey /ctrl /itemnotify in pack${notifyPackSlot} ${notifyItemSlot} leftmouseup

    /delay 2

    /click left target 

    /delay 2 

    /if (${Window[TradeWnd].Open}) /nomodkey /notify TradeWnd TRDW_Trade_Button leftmouseup
    /varcalc givenCount ${givenCount}+1
    /delay 5

   | /if (${givenCount} < 4) /goto :giveLoop
   
    /echo trading
    /nomodkey /notify TradeWnd TRDW_Trade_Button leftmouseup
    /delay 5

/return 